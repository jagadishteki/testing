import{a as re,b as le,c as me,d as pe,e as se,f as de}from"./chunk-T5UNL7BY.js";import{a as ce,b as ge}from"./chunk-375PY2ZT.js";import{a as oe}from"./chunk-ICU2YCUX.js";import{b as z,c as y,d as H,e as R,f as J,h as K,i as Q,j as X,k as Y,l as Z,m as ee,n as te,r as ne,s as ie,t as ae}from"./chunk-4PTF3XG6.js";import"./chunk-YW6BY2TY.js";import{a as B}from"./chunk-SS7WDJWM.js";import{k as j,l as $,m as U,p as P}from"./chunk-DYBXCSNB.js";import{$ as k,$a as g,Ab as s,Bb as A,Cb as T,Eb as F,Fb as b,Gb as M,Hb as q,Ib as O,Jb as V,Lb as L,Ma as m,Mb as W,Na as w,Nb as G,Q as N,W as D,bb as p,ib as i,ja as f,jb as o,ka as C,kb as h,lb as S,mb as x,ob as I,rb as v,sb as d,zb as E}from"./chunk-ZN5V4DRT.js";import"./chunk-CWTPBX7D.js";var _e=(()=>{let l=class l{constructor(){this.http=D(B)}getCampaigns(){return this.http.get("https://web-api-cu1b.onrender.com/campaigns/")}addCampaign(n){return this.http.post("https://web-api-cu1b.onrender.com/campaigns/",n)}updateCampaign(n){return this.http.put("https://web-api-cu1b.onrender.com/campaigns/"+n.id,n)}deleteCampaign(n){return this.http.delete("https://web-api-cu1b.onrender.com/campaigns/"+n)}};l.\u0275fac=function(r){return new(r||l)},l.\u0275prov=N({token:l,factory:l.\u0275fac,providedIn:"root"});let t=l;return t})();var he=(t,l)=>({itemsPerPage:t,currentPage:l}),ue=()=>({standalone:!0});function ve(t,l){if(t&1&&(i(0,"option",61),s(1),o()),t&2){let e=l.$implicit;p("value",e.autoId),m(),A(e.name)}}function Se(t,l){t&1&&h(0,"i",66)}function xe(t,l){t&1&&h(0,"i",67)}function ye(t,l){if(t&1){let e=I();S(0),i(1,"th"),s(2),i(3,"a",63),v("click",function(){f(e);let r=d().$implicit,a=d();return C(a.sortAsc(r.field))}),g(4,Se,1,0,"i",64),o(),i(5,"a",63),v("click",function(){f(e);let r=d().$implicit,a=d();return C(a.sortDsc(r.field))}),g(6,xe,1,0,"i",65),o()(),x()}if(t&2){let e=d().$implicit;m(2),T("",e.header," "),m(2),p("ngIf",e.iconDisplay),m(2),p("ngIf",!e.iconDisplay)}}function Ie(t,l){if(t&1&&(S(0),g(1,ye,7,3,"ng-container",62),x()),t&2){let e=l.$implicit;m(),p("ngIf",e.displayField)}}function Te(t,l){if(t&1){let e=I();S(0),i(1,"input",68),v("input",function(r){f(e);let a=d(2).$implicit,c=d();return C(c.inputSearch(r,a.field))}),o(),x()}}function we(t,l){if(t&1&&(i(0,"option",61),s(1),o()),t&2){let e=l.$implicit;p("value",e.autoId),m(),T("",e.name," ")}}function Ee(t,l){if(t&1){let e=I();S(0),i(1,"select",69),v("change",function(r){f(e);let a=d(3).$implicit,c=d();return C(c.inputSearch(r,a.field))}),i(2,"option",12),s(3,"Any"),o(),g(4,we,2,2,"option",13),o(),x()}if(t&2){let e=d(4);m(),p("ngModel",-1),m(3),p("ngForOf",e.businessUnits)}}function Fe(t,l){if(t&1){let e=I();S(0),i(1,"select",69),v("change",function(r){f(e);let a=d(3).$implicit,c=d();return C(c.inputSearch(r,a.field))}),i(2,"option",12),s(3,"Any"),o(),i(4,"option",23),s(5,"Approved"),o(),i(6,"option",70),s(7,"Not Approved"),o()(),x()}t&2&&(m(),p("ngModel",-1))}function be(t,l){if(t&1){let e=I();S(0),i(1,"select",69),v("change",function(r){f(e);let a=d(3).$implicit,c=d();return C(c.inputSearch(r,a.field))}),i(2,"option",12),s(3,"Any"),o(),i(4,"option",23),s(5,"Active"),o(),i(6,"option",70),s(7,"Inactive"),o()(),x()}t&2&&(m(),p("ngModel",-1))}function Me(t,l){if(t&1&&(S(0),g(1,Ee,5,2,"ng-container",62)(2,Fe,8,1,"ng-container",62)(3,be,8,1,"ng-container",62),x()),t&2){let e=d(2).$implicit;m(),p("ngIf",e.id==5),m(),p("ngIf",e.id==6),m(),p("ngIf",e.id==7)}}function Ae(t,l){if(t&1&&(i(0,"td"),g(1,Te,2,0,"ng-container",62)(2,Me,4,3,"ng-container",62),o()),t&2){let e=d().$implicit,n=d();m(),p("ngIf",!n.dropdowns.includes(e.id)),m(),p("ngIf",n.dropdowns.includes(e.id))}}function Ve(t,l){if(t&1&&(S(0),g(1,Ae,3,2,"td",62),x()),t&2){let e=l.$implicit;m(),p("ngIf",e.displayField)}}function Ne(t,l){if(t&1&&(S(0),s(1),x()),t&2){let e=d(2).$implicit,n=d().$implicit;m(),T(" ",n[e.field]," ")}}function De(t,l){if(t&1&&(S(0),s(1),x()),t&2){let e=d(3).$implicit,n=d().$implicit,r=d();m(),T(" ",r.campaignTypes(n[e.field])," ")}}function ke(t,l){if(t&1&&(S(0),s(1),x()),t&2){let e=d(3).$implicit,n=d().$implicit,r=d();m(),T(" ",r.campaignGroups(n[e.field])," ")}}function qe(t,l){if(t&1&&(S(0),s(1),x()),t&2){let e=d().$implicit;m(),T(" ",e.name," ")}}function Oe(t,l){if(t&1&&(S(0),g(1,qe,2,1,"ng-container",62),x()),t&2){let e=l.$implicit,n=d(4).$implicit,r=d().$implicit;m(),p("ngIf",e.autoId==r[n.field])}}function Le(t,l){if(t&1&&(S(0),g(1,Oe,2,1,"ng-container",33),x()),t&2){let e=d(5);m(),p("ngForOf",e.businessUnits)}}function We(t,l){if(t&1&&(S(0),s(1),x()),t&2){let e=d(3).$implicit,n=d().$implicit;m(),T(" ",n[e.field]==1?"Approved":"Not Approved"," ")}}function Ge(t,l){if(t&1&&(S(0),s(1),x()),t&2){let e=d(3).$implicit,n=d().$implicit;m(),T(" ",n[e.field]==1?"Active":"Inactive"," ")}}function je(t,l){if(t&1&&(S(0),g(1,De,2,1,"ng-container",62)(2,ke,2,1,"ng-container",62)(3,Le,2,1,"ng-container",62)(4,We,2,1,"ng-container",62)(5,Ge,2,1,"ng-container",62),x()),t&2){let e=d(2).$implicit;m(),p("ngIf",e.id==2),m(),p("ngIf",e.id==3),m(),p("ngIf",e.id==5),m(),p("ngIf",e.id==6),m(),p("ngIf",e.id==7)}}function $e(t,l){if(t&1&&(i(0,"td"),g(1,Ne,2,1,"ng-container",62)(2,je,6,5,"ng-container",62),o()),t&2){let e=d().$implicit,n=d(2);m(),p("ngIf",!n.dropdowns.includes(e.id)),m(),p("ngIf",n.dropdowns.includes(e.id))}}function Ue(t,l){if(t&1&&(S(0),g(1,$e,3,2,"td",62),x()),t&2){let e=l.$implicit;m(),p("ngIf",e.displayField)}}function Pe(t,l){if(t&1){let e=I();i(0,"i",75),v("click",function(){f(e);let r=d().$implicit,a=d();return C(a.campaignStatus(r.id,0))}),o()}}function Be(t,l){if(t&1){let e=I();i(0,"i",76),v("click",function(){f(e);let r=d().$implicit,a=d();return C(a.campaignStatus(r.id,1))}),o()}}function ze(t,l){if(t&1){let e=I();i(0,"tr"),g(1,Ue,2,1,"ng-container",33),i(2,"td")(3,"i",71),v("click",function(){let r=f(e).$implicit,a=d();return C(a.editCampaign(r))}),o(),g(4,Pe,1,0,"i",72)(5,Be,1,0,"i",73),i(6,"i",74),v("click",function(){let r=f(e).$implicit,a=d();return C(a.deleteCampaign(r.id))}),o()()()}if(t&2){let e=l.$implicit,n=d();m(),p("ngForOf",n.headers),m(3),p("ngIf",e.campStatus==1),m(),p("ngIf",e.campStatus==0)}}function He(t,l){if(t&1&&(i(0,"div",77),s(1),o()),t&2){let e=d();p("ngClass",e.messageType=="success"?"alert alert-success":"alert alert-danger"),m(),T(" ",e.message,"")}}function Re(t,l){t&1&&(i(0,"div"),s(1," Name is required. "),o())}function Je(t,l){if(t&1&&(i(0,"div",78),g(1,Re,2,0,"div",62),o()),t&2){let e=d();m(),p("ngIf",e.campaignForm.controls.name==null||e.campaignForm.controls.name.errors==null?null:e.campaignForm.controls.name.errors.required)}}function Ke(t,l){t&1&&(i(0,"div",78),s(1," Select Group "),o())}function Qe(t,l){t&1&&(i(0,"div"),s(1," Date is required. "),o())}function Xe(t,l){if(t&1&&(i(0,"div",78),g(1,Qe,2,0,"div",62),o()),t&2){let e=d();m(),p("ngIf",e.campaignForm.controls.date==null||e.campaignForm.controls.date.errors==null?null:e.campaignForm.controls.date.errors.required)}}function Ye(t,l){t&1&&(i(0,"div"),s(1," Date is required. "),o())}function Ze(t,l){if(t&1&&(i(0,"div",78),g(1,Ye,2,0,"div",62),o()),t&2){let e=d();m(),p("ngIf",e.campaignForm.controls.date==null||e.campaignForm.controls.date.errors==null?null:e.campaignForm.controls.date.errors.required)}}function et(t,l){if(t&1&&(i(0,"option",61),s(1),o()),t&2){let e=l.$implicit;p("value",e.autoId),m(),A(e.name)}}function tt(t,l){t&1&&(i(0,"div",78),s(1," Select Campaign "),o())}function nt(t,l){t&1&&(i(0,"div",78),s(1," DLT Id is required. "),o())}function it(t,l){t&1&&(i(0,"div",78),s(1," Sender Id is required. "),o())}function at(t,l){t&1&&(i(0,"div"),s(1," SMS Template is required. "),o())}function ot(t,l){if(t&1&&(i(0,"div",78),g(1,at,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.smsTemplate==null||e.campaignForm.controls.smsTemplate.errors==null?null:e.campaignForm.controls.smsTemplate.errors.required)}}function rt(t,l){if(t&1&&(i(0,"div",79)(1,"h5",80),s(2,"SMS Template"),o(),i(3,"div",3)(4,"div",28)(5,"div",3)(6,"div",81)(7,"label",82),s(8,"DLT ID"),i(9,"sup"),s(10,"*"),o()()(),i(11,"div",83),h(12,"input",84),o(),h(13,"div",44),i(14,"div",83),g(15,nt,2,0,"div",48),o()()(),i(16,"div",28)(17,"div",3)(18,"div",81)(19,"label",85),s(20,"Sender ID"),i(21,"sup"),s(22,"*"),o()()(),i(23,"div",83),h(24,"input",86),o(),h(25,"div",44),i(26,"div",83),g(27,it,2,0,"div",48),o()()()(),i(28,"div",87)(29,"label",88),s(30,"SMS Template "),i(31,"sup"),s(32,"*"),o()(),h(33,"textarea",89),g(34,ot,2,1,"div",48),o()()),t&2){let e=d();m(15),p("ngIf",e.dropdownListType[0].validation&&(e.campaignForm.controls.dltId==null?null:e.campaignForm.controls.dltId.invalid)&&((e.campaignForm.controls.dltId==null?null:e.campaignForm.controls.dltId.dirty)||(e.campaignForm.controls.dltId==null?null:e.campaignForm.controls.dltId.touched))),m(12),p("ngIf",e.dropdownListType[0].validation&&(e.campaignForm.controls.senderId==null?null:e.campaignForm.controls.senderId.invalid)&&((e.campaignForm.controls.senderId==null?null:e.campaignForm.controls.senderId.dirty)||(e.campaignForm.controls.senderId==null?null:e.campaignForm.controls.senderId.touched))),m(7),p("ngIf",(e.campaignForm.controls.smsTemplate==null?null:e.campaignForm.controls.smsTemplate.invalid)&&((e.campaignForm.controls.smsTemplate==null?null:e.campaignForm.controls.smsTemplate.dirty)||(e.campaignForm.controls.smsTemplate==null?null:e.campaignForm.controls.smsTemplate.touched)))}}function lt(t,l){t&1&&(i(0,"div"),s(1," From Name is required. "),o())}function mt(t,l){if(t&1&&(i(0,"div",78),g(1,lt,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.fromName==null||e.campaignForm.controls.fromName.errors==null?null:e.campaignForm.controls.fromName.errors.required)}}function pt(t,l){t&1&&(i(0,"div"),s(1," From Email is required. "),o())}function st(t,l){if(t&1&&(i(0,"div",78),g(1,pt,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.fromEmail==null||e.campaignForm.controls.fromEmail.errors==null?null:e.campaignForm.controls.fromEmail.errors.required)}}function dt(t,l){t&1&&(i(0,"div"),s(1," Email Subject is required. "),o())}function ct(t,l){if(t&1&&(i(0,"div",78),g(1,dt,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.emailSubject==null||e.campaignForm.controls.emailSubject.errors==null?null:e.campaignForm.controls.emailSubject.errors.required)}}function gt(t,l){t&1&&(i(0,"div"),s(1," Email Content is required. "),o())}function _t(t,l){if(t&1&&(i(0,"div",78),g(1,gt,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.emailTemplate==null||e.campaignForm.controls.emailTemplate.errors==null?null:e.campaignForm.controls.emailTemplate.errors.required)}}function ut(t,l){if(t&1&&(i(0,"div",90)(1,"h5",80),s(2,"Email Template"),o(),i(3,"div",91)(4,"label",92),s(5,"From Name"),o(),i(6,"div",93),h(7,"input",94),o(),g(8,mt,2,1,"div",48),o(),i(9,"div",91)(10,"label",95),s(11,"From Email"),o(),i(12,"div",93),h(13,"input",96),o(),g(14,st,2,1,"div",48),o(),i(15,"div",91)(16,"label",97),s(17,"Email Subject"),o(),i(18,"div",93),h(19,"input",98),o(),g(20,ct,2,1,"div",48),o(),i(21,"div",99),h(22,"angular-editor",100),g(23,_t,2,1,"div",48),o()()),t&2){let e=d();m(8),p("ngIf",e.dropdownListType[1].validation&&(e.campaignForm.controls.fromName==null?null:e.campaignForm.controls.fromName.invalid)&&((e.campaignForm.controls.fromName==null?null:e.campaignForm.controls.fromName.dirty)||(e.campaignForm.controls.fromName==null?null:e.campaignForm.controls.fromName.touched))),m(6),p("ngIf",e.dropdownListType[1].validation&&(e.campaignForm.controls.fromEmail==null?null:e.campaignForm.controls.fromEmail.invalid)&&((e.campaignForm.controls.fromEmail==null?null:e.campaignForm.controls.fromEmail.dirty)||(e.campaignForm.controls.fromEmail==null?null:e.campaignForm.controls.fromEmail.touched))),m(6),p("ngIf",e.dropdownListType[1].validation&&(e.campaignForm.controls.emailSubject==null?null:e.campaignForm.controls.emailSubject.invalid)&&((e.campaignForm.controls.emailSubject==null?null:e.campaignForm.controls.emailSubject.dirty)||(e.campaignForm.controls.emailSubject==null?null:e.campaignForm.controls.emailSubject.touched))),m(2),p("config",e.config),m(),p("ngIf",e.dropdownListType[1].validation&&(e.campaignForm.controls.emailTemplate==null?null:e.campaignForm.controls.emailTemplate.invalid)&&((e.campaignForm.controls.emailTemplate==null?null:e.campaignForm.controls.emailTemplate.dirty)||(e.campaignForm.controls.emailTemplate==null?null:e.campaignForm.controls.emailTemplate.touched)))}}function ft(t,l){t&1&&(i(0,"div"),s(1," WhatsApp Id is required. "),o())}function Ct(t,l){if(t&1&&(i(0,"div",78),g(1,ft,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.WhatsAppId==null||e.campaignForm.controls.WhatsAppId.errors==null?null:e.campaignForm.controls.WhatsAppId.errors.required)}}function ht(t,l){t&1&&(i(0,"div"),s(1," WhatsApp Sender Id is required. "),o())}function vt(t,l){if(t&1&&(i(0,"div",78),g(1,ht,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.WhatsAppSenderId==null||e.campaignForm.controls.WhatsAppSenderId.errors==null?null:e.campaignForm.controls.WhatsAppSenderId.errors.required)}}function St(t,l){t&1&&(i(0,"div"),s(1," WhatsApp Content is required. "),o())}function xt(t,l){if(t&1&&(i(0,"div",78),g(1,St,2,0,"div",62),o()),t&2){let e=d(2);m(),p("ngIf",e.campaignForm.controls.whatsAppTemplate==null||e.campaignForm.controls.whatsAppTemplate.errors==null?null:e.campaignForm.controls.whatsAppTemplate.errors.required)}}function yt(t,l){if(t&1&&(i(0,"div",101)(1,"h5",80),s(2,"WhatsApp Template"),o(),i(3,"div",3)(4,"div",28)(5,"div",3)(6,"div",81)(7,"label",102),s(8,"WhatsApp ID"),i(9,"sup"),s(10,"*"),o()()(),i(11,"div",83),h(12,"input",103),o(),h(13,"div",44),i(14,"div",83),g(15,Ct,2,1,"div",48),o()()(),i(16,"div",28)(17,"div",3)(18,"div",81)(19,"label",104),s(20,"Sender ID"),i(21,"sup"),s(22,"*"),o()()(),i(23,"div",83),h(24,"input",105),o(),h(25,"div",44),i(26,"div",83),g(27,vt,2,1,"div",48),o()()()(),i(28,"div",99),h(29,"angular-editor",106),g(30,xt,2,1,"div",48),o()()),t&2){let e=d();m(15),p("ngIf",e.dropdownListType[2].validation&&(e.campaignForm.controls.WhatsAppId==null?null:e.campaignForm.controls.WhatsAppId.invalid)&&((e.campaignForm.controls.WhatsAppId==null?null:e.campaignForm.controls.WhatsAppId.dirty)||(e.campaignForm.controls.WhatsAppId==null?null:e.campaignForm.controls.WhatsAppId.touched))),m(12),p("ngIf",e.dropdownListType[2].validation&&(e.campaignForm.controls.whatsAppSenderId==null?null:e.campaignForm.controls.whatsAppSenderId.invalid)&&((e.campaignForm.controls.whatsAppSenderId==null?null:e.campaignForm.controls.whatsAppSenderId.dirty)||(e.campaignForm.controls.whatsAppSenderId==null?null:e.campaignForm.controls.whatsAppSenderId.touched))),m(2),p("config",e.config),m(),p("ngIf",e.dropdownListType[2].validation&&(e.campaignForm.controls.whatsAppTemplate==null?null:e.campaignForm.controls.whatsAppTemplate.invalid)&&((e.campaignForm.controls.whatsAppTemplate==null?null:e.campaignForm.controls.whatsAppTemplate.dirty)||(e.campaignForm.controls.whatsAppTemplate==null?null:e.campaignForm.controls.whatsAppTemplate.touched)))}}function It(t,l){if(t&1){let e=I();i(0,"button",107),v("click",function(){f(e);let r=d(),a=E(70);return C(r.submitCampaign(r.campaignForm.value,a))}),s(1,"Submit"),o()}}function Tt(t,l){if(t&1){let e=I();i(0,"button",107),v("click",function(){f(e);let r=d();return C(r.updateCampaign())}),s(1,"Update"),o()}}var jt=(()=>{let l=class l{constructor(n,r,a,c){this.dataService=n,this.contactService=r,this.campaignService=a,this.formBuilder=c,this.config={editable:!0,spellcheck:!0,height:"20rem",minHeight:"5rem",placeholder:"Enter text here...",translate:"no",defaultParagraphSeparator:"p",defaultFontName:"Arial"},this.p=1,this.ipp=2,this.headers=[{id:1,field:"campaignName",displayField:!0,header:"Campaign",iconDisplay:!0},{id:2,field:"campaignIds",displayField:!0,header:"Campaign Type",iconDisplay:!0},{id:3,field:"groupIds",displayField:!0,header:"Contact Group",iconDisplay:!0},{id:4,field:"scheduledOn",displayField:!0,header:"Scheduled",iconDisplay:!0},{id:5,field:"unitId",displayField:!0,header:"Unit Name",iconDisplay:!0},{id:6,field:"approved",displayField:!0,header:"Approved",iconDisplay:!0},{id:7,field:"campStatus",displayField:!0,header:"Camp Status",iconDisplay:!0},{id:8,field:"createdOn",displayField:!0,header:"Created",iconDisplay:!0}],this.dropdowns=[2,3,5,6,7],this.dropdownList=this.headers,this.dropdownListType=[{id:1,campaignType:"SMS",validation:!1},{id:2,campaignType:"Email",validation:!1},{id:3,campaignType:"WhatsApp",validation:!1}],this.dropdownListGroup=[],this.dropdownSettings={singleSelection:!1,idField:"id",textField:"header",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:10,allowSearchFilter:!0},this.dropdownSettingsType={singleSelection:!1,idField:"id",textField:"campaignType",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:10,allowSearchFilter:!0},this.dropdownSettingsGroup={singleSelection:!1,idField:"id",textField:"name",enableCheckAll:!1,unSelectAllText:"UnSelect All",itemsShowLimit:10,allowSearchFilter:!0},this.selectedItems=[{id:1,header:"Campaign"},{id:2,header:"Campaign Type"},{id:3,header:"Contact Group"},{id:4,header:"Scheduled"},{id:5,header:"Unit Name"},{id:6,header:"Approved"},{id:7,header:"Camp Status"},{id:8,header:"Scheduled"}],this.selectedItemsType=[],this.selectedItemsGroup=[],this.smsTemplate=!1,this.emailTemplate=!1,this.whatsAppTemplate=!1}ngOnInit(){this.getCampaigns(),this.getAllBusinessUnits(),this.getGroups(),this.createCampaign()}updateValidation(){this.dropdownListType.forEach(n=>{n.validation=!1}),this.selectedItemsType.forEach(n=>{this.dropdownListType.forEach(r=>{n.id==r.id&&(r.validation=!0)})})}createCampaign(){this.campaignForm=this.formBuilder.group({name:["",y.required],date:["",y.required],time:[""],businessUnit:["-1",y.required],dltId:["",y.required],senderId:["",y.required],smsTemplate:["Hi {PatientName}, Write SMS Body Here",y.required],fromName:["",y.required],fromEmail:["",y.required],emailSubject:["",y.required],emailTemplate:["",y.required],whatsAppId:["",y.required],whatsAppSenderId:["",y.required],whatsAppTemplate:["",y.required]})}getGroups(){this.contactService.getGroups().subscribe({next:n=>{this.dropdownListGroup=n}})}submitCampaign(n,r){let a=this.selectedItemsType.map(_=>_.id),c=this.selectedItemsGroup.map(_=>_.id),u={campaignName:n.name,campaignIds:a,dltId:n.dltId,senderId:n.senderId,smsTemplate:n.smsTemplate,fromName:n.fromName,fromEmail:n.fromEmail,emailSubject:n.emailSubject,emailTemplate:n.emailTemplate,whatsAppId:n.whatsAppId,whatsAppSenderId:n.whatsAppSenderId,whatsAppTemplate:n.whatsAppTemplate,groupIds:c,scheduledOn:n.date+" "+n.time,createdOn:new Date().toISOString().split(".")[0].replace("T"," "),unitId:n.businessUnit,approved:0,campStatus:1};console.log(u),this.campaignService.addCampaign(u).subscribe({next:_=>{console.log(_),this.message="Contact Added Successfully",this.messageType="success",this.createCampaign(),r.submitted=!1,this.selectedItemsType=[],this.selectedItemsGroup=[],setTimeout(()=>{this.message="",this.messageType=""},3e3),this.getCampaigns()},error:_=>{this.message=_.error.error,this.messageType="error",setTimeout(()=>{this.message="",this.messageType=""},3e3)}})}modalOpen(n){let r=document.getElementById(n);r&&(r.style.display="block")}modalClose(n){let r=document.getElementById(n);r&&(r.style.display="none")}addCampaign(){this.formType="add";let n=document.getElementById("form-title");n&&(n.innerText="Add Campaign"),this.modalOpen("campaign")}editCampaign(n){this.editCampaignId=n.id,this.formType="edit";let r=document.getElementById("form-title");r&&(r.innerText="Edit Campaign");let a=n.scheduledOn.split(" ")[0],c=n.scheduledOn.split(" ")[1]?n.scheduledOn.split(" ")[1]:"00:00";this.campaignForm.setValue({name:n.campaignName,date:a,time:c,businessUnit:n.unitId,dltId:n.dltId,senderId:n.senderId,smsTemplate:n.smsTemplate,fromName:n.fromName,fromEmail:n.fromEmail,emailSubject:n.emailSubject,emailTemplate:n.emailTemplate,whatsAppId:n.whatsAppId,whatsAppSenderId:n.whatsAppSenderId,whatsAppTemplate:n.whatsAppTemplate}),n.campaignIds.forEach(u=>{this.dropdownListType.forEach(_=>{u==_.id&&this.selectedItemsType.push({id:_.id,campaignType:_.campaignType})})}),this.selectedItemsType=[...this.selectedItemsType],this.getGroups(),n.groupIds.forEach(u=>{this.dropdownListGroup.forEach(_=>{u==_.id&&this.selectedItemsGroup.push({id:_.id,name:_.name})})}),this.selectedItemsGroup=[...this.selectedItemsGroup],this.modalOpen("campaign")}updateCampaign(){let n=this.selectedItemsType.map(c=>c.id),r=this.selectedItemsGroup.map(c=>c.id),a={id:this.editCampaignId,campaignName:this.campaignForm.controls.name.value,campaignIds:n,dltId:this.campaignForm.controls.dltId.value,senderId:this.campaignForm.controls.senderId.value,smsTemplate:this.campaignForm.controls.smsTemplate.value,fromName:this.campaignForm.controls.fromName.value,fromEmail:this.campaignForm.controls.fromEmail.value,emailSubject:this.campaignForm.controls.emailSubject.value,emailTemplate:this.campaignForm.controls.emailTemplate.value,whatsAppId:this.campaignForm.controls.whatsAppId.value,whatsAppSenderId:this.campaignForm.controls.whatsAppSenderId.value,whatsAppTemplate:this.campaignForm.controls.whatsAppTemplate.value,groupIds:r,scheduledOn:this.campaignForm.controls.date.value+" "+this.campaignForm.controls.time.value,unitId:this.campaignForm.controls.businessUnit.value};console.log(a),this.campaignService.updateCampaign(a).subscribe({next:c=>{console.log(c),this.message="Campaign Updated Successfully",this.messageType="success",this.filteredCampaigns.forEach(u=>{u.id==a.id&&(u.name=a.campaignName,u.campaignIds=a.campaignIds,u.groupIds=a.groupIds,u.scheduledOn=a.scheduledOn,u.unitId=a.unitId)}),setTimeout(()=>{this.message="",this.messageType=""},3e3),this.modalClose("campaign")},error:c=>{this.message=c.error.error,this.messageType="error",setTimeout(()=>{this.message="",this.messageType=""},3e3),this.modalClose("campaign")}})}campaignStatus(n,r){}deleteCampaign(n){this.campaignService.deleteCampaign(n).subscribe({next:r=>{this.filteredCampaigns=this.filteredCampaigns.filter(a=>a.id!=n)}})}inputSearch(n,r){this.p=1;let a=n.target.value;this.filteredCampaigns=this.campaigns.filter(c=>Number.isInteger(c[r])?a==-1?!0:c[r]==Number(a):c[r].toLowerCase().includes(a.toLowerCase()))}getCampaigns(){this.campaignService.getCampaigns().subscribe({next:n=>{this.campaigns=n,this.filteredCampaigns=this.campaigns}})}sortAsc(n){this.headers.filter(r=>{r.field==n&&(r.iconDisplay=!1)}),this.filteredCampaigns=this.filteredCampaigns.sort((r,a)=>r[n]>a[n]?1:-1)}sortDsc(n){this.headers.filter(r=>{r.field==n&&(r.iconDisplay=!0)}),this.filteredCampaigns=this.filteredCampaigns.sort((r,a)=>a[n]>r[n]?1:-1)}onItemSelect(n){this.headers.forEach(r=>{n.id==r.id&&(r.displayField=!0)})}onItemSelect2(n){}onItemDeSelect(n){this.headers.forEach(r=>{n.id==r.id&&(r.displayField=!1)})}onSelectAll(n){}onSelectAll2(n){}searchStatus(n){this.p=1;let r=n.fromDate||"2000-01-01",a=n.toDate||"9999-12-31",c=Number(n.businessUnit);console.log(r,a,c),this.filteredCampaigns=this.campaigns.filter(u=>u.createdOn>r&&u.createdOn<a&&(c!==-1?u.unitName==c:u.unitName!==c))}getAllBusinessUnits(){this.dataService.getAllBussinessUnits().subscribe({next:n=>{this.businessUnits=n.response}})}campaignTypes(n){let r=[];return n.forEach(a=>{this.dropdownListType.forEach(c=>{a==c.id&&r.push(c.campaignType)})}),r}campaignGroups(n){let r=[];return n.forEach(a=>{this.dropdownListGroup.forEach(c=>{a==c.id&&r.push(c.name)})}),r}records(n){console.log(n.target.value),this.ipp=n.target.value}};l.\u0275fac=function(r){return new(r||l)(w(oe),w(de),w(_e),w(ne))},l.\u0275cmp=k({type:l,selectors:[["app-manage-campaigns"]],standalone:!0,features:[q([]),O],decls:123,vars:38,consts:[["searchForm","ngForm"],["campaignTemplate","ngForm"],[1,"container-fluid"],[1,"row"],[1,"col-3"],["type","button",1,"btn","btn-success","btn-sm","ms-3",3,"click"],[1,"bi","bi-file-earmark-plus","me-2"],[1,"mt-3","row",3,"ngSubmit"],[1,"col-md-3"],["type","text","name","fromDate","ngModel","","onfocus","(this.type='date')","onblur","(this.type='text')","placeholder","From Date",1,"form-control","form-control-sm"],["type","text","name","toDate","ngModel","","onfocus","(this.type='date')","onblur","(this.type='text')","placeholder","To Date",1,"form-control","form-control-sm"],["name","businessUnit","aria-label","Default select example",1,"form-select","form-select-sm",3,"ngModel"],["value","-1"],[3,"value",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-sm","btn-success","px-3","w-50"],["type","button",1,"btn","btn-sm","btn-warning","px-3","w-50",3,"click"],[1,"row","mt-3"],[1,"col-md-12","text-end"],[3,"ngModelChange","onSelect","onDeSelect","onSelectAll","settings","data","ngModel"],[1,"mt-3"],[1,"col-md-6","d-flex","align-items-center"],[1,"label"],[1,"form-select","form-select-sm","w-25","mx-3",3,"ngModelChange","change","ngModel"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],[1,"col-md-6"],[1,"float-end"],[3,"pageChange"],[1,"table","table-striped","table-bordered"],[1,"table-success"],[4,"ngFor","ngForOf"],["width","15%"],["tabindex","-1","id","campaign",1,"modal","modal-backdrop"],[1,"modal-dialog","group"],[1,"modal-content"],[3,"ngClass",4,"ngIf"],[1,"modal-header"],["id","form-title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","form-horizontal",3,"formGroup"],[1,"col-md-4"],[1,"mb-3"],["for","name"],["type","text","id","name","placeholder","Enter Campaign Name","formControlName","name",1,"form-control"],["class","alert alert-danger",4,"ngIf"],["name","campaingGroup",3,"ngModelChange","settings","data","ngModel","ngModelOptions"],["for","date"],["type","date","id","date","formControlName","date","placeholder","Select Date",1,"form-control","form-control-sm"],["for","time"],["type","time","id","time","formControlName","time",1,"form-control","form-control-sm"],["formControlName","businessUnit",1,"form-select"],[1,"col-md-8","template"],["name","campaingType",3,"ngModelChange","settings","data","ngModel","ngModelOptions"],["class","sms-template",4,"ngIf"],["class","email-template",4,"ngIf"],["class","whatsApp-template",4,"ngIf"],["class","btn btn-success w-100",3,"click",4,"ngIf"],[3,"value"],[4,"ngIf"],[3,"click"],["class","bi bi-sort-down-alt",4,"ngIf"],["class","bi bi-sort-up",4,"ngIf"],[1,"bi","bi-sort-down-alt"],[1,"bi","bi-sort-up"],["type","text",1,"form-control","form-control-sm",3,"input"],["aria-label","Default select example",1,"form-select","form-select-sm",3,"change","ngModel"],["value","0"],[1,"bi","bi-pencil-square","fs-20",3,"click"],["class","bi bi-check-square-fill fs-20",3,"click",4,"ngIf"],["class","bi bi-x-square-fill fs-20",3,"click",4,"ngIf"],[1,"bi","bi-trash","fs-20",3,"click"],[1,"bi","bi-check-square-fill","fs-20",3,"click"],[1,"bi","bi-x-square-fill","fs-20",3,"click"],[3,"ngClass"],[1,"alert","alert-danger"],[1,"sms-template"],[1,"text-success"],[1,"col-md-4","d-flex","align-items-center"],["for","dltId"],[1,"col-md-8"],["type","text","id","dltId","placeholder","Enter DLT Id","formControlName","dltId",1,"form-control","form-control-sm"],["for","senderId"],["type","text","id","senderId","placeholder","Enter Sender Id","formControlName","senderId",1,"form-control","form-control-sm"],[1,"mt-2","mb-3"],["for","smsTemplate",1,"form-label"],["id","smsTemplate","formControlName","smsTemplate","placeholder","Enter SMS Template","rows","4",1,"form-control"],[1,"email-template"],[1,"mb-1","row"],["for","fromName",1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["type","text","id","fromName","formControlName","fromName",1,"form-control","form-control-sm"],["for","fromEmail",1,"col-sm-3","col-form-label"],["type","text","id","fromEmail","formControlName","fromEmail",1,"form-control","form-control-sm"],["for","emailSubject",1,"col-sm-3","col-form-label"],["type","text","id","emailSubject","formControlName","emailSubject",1,"form-control","form-control-sm"],[1,"mb-3","row"],["id","editorEmail","formControlName","emailTemplate",3,"config"],[1,"whatsApp-template"],["for","whatsAppId"],["type","text","id","whatsAppId","placeholder","Enter WhatsApp Id","formControlName","whatsAppId",1,"form-control","form-control-sm"],["for","whatsAppSenderId"],["type","text","id","whatsAppSenderId","placeholder","Enter WhatsApp Sender Id","formControlName","whatsAppSenderId",1,"form-control","form-control-sm"],["id","editorWhatsApp","formControlName","whatsAppTemplate",3,"config"],[1,"btn","btn-success","w-100",3,"click"]],template:function(r,a){if(r&1){let c=I();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"h3"),s(4,"Manage Campaigns"),o()(),i(5,"div",4)(6,"button",5),v("click",function(){return f(c),C(a.addCampaign())}),h(7,"i",6),s(8,"Add Campaign "),o()()(),i(9,"form",7,0),v("ngSubmit",function(){f(c);let _=E(10);return C(a.searchStatus(_.value))}),i(11,"div",8),h(12,"input",9),o(),i(13,"div",8),h(14,"input",10),o(),i(15,"div",8)(16,"select",11)(17,"option",12),s(18,"Any Business Unit"),o(),g(19,ve,2,2,"option",13),o()(),i(20,"div",8)(21,"button",14),s(22,"Search"),o(),i(23,"button",15),v("click",function(){f(c);let _=E(10);return C(_.reset())}),s(24,"Reset"),o()()(),i(25,"div",16)(26,"div",17)(27,"ng-multiselect-dropdown",18),M("ngModelChange",function(_){return f(c),b(a.selectedItems,_)||(a.selectedItems=_),C(_)}),v("onSelect",function(_){return f(c),C(a.onItemSelect(_))})("onDeSelect",function(_){return f(c),C(a.onItemDeSelect(_))})("onSelectAll",function(_){return f(c),C(a.onSelectAll(_))}),o()()(),i(28,"div",19)(29,"div",3)(30,"div",20)(31,"span",21),s(32," Records Per Page "),o(),i(33,"select",22),M("ngModelChange",function(_){return f(c),b(a.ipp,_)||(a.ipp=_),C(_)}),v("change",function(_){return f(c),C(a.records(_))}),i(34,"option",23),s(35,"1"),o(),i(36,"option",24),s(37,"2"),o(),i(38,"option",25),s(39,"3"),o(),i(40,"option",26),s(41,"4"),o(),i(42,"option",27),s(43,"5"),o()()(),i(44,"div",28)(45,"div",29)(46,"pagination-controls",30),v("pageChange",function(_){return f(c),C(a.p=_)}),o()()()(),i(47,"table",31)(48,"thead")(49,"tr",32),g(50,Ie,2,1,"ng-container",33),i(51,"th"),s(52,"Actions"),o()()(),i(53,"tbody")(54,"tr"),g(55,Ve,2,1,"ng-container",33),h(56,"td",34),o(),g(57,ze,7,3,"tr",33),W(58,"paginate"),o()(),i(59,"div",29)(60,"pagination-controls",30),v("pageChange",function(_){return f(c),C(a.p=_)}),o()()(),i(61,"div",35)(62,"div",36)(63,"div",37),g(64,He,2,2,"div",38),i(65,"div",39),h(66,"h5",40),i(67,"button",41),v("click",function(){return f(c),C(a.modalClose("campaign"))}),o()(),i(68,"div",42)(69,"form",43,1)(71,"div",44)(72,"div",45)(73,"label",46),s(74,"Campaign Name "),i(75,"sup"),s(76,"*"),o()(),h(77,"input",47),g(78,Je,2,1,"div",48),o(),i(79,"div",45)(80,"label"),s(81,"Groups"),i(82,"sup"),s(83,"*"),o()(),i(84,"ng-multiselect-dropdown",49),M("ngModelChange",function(_){return f(c),b(a.selectedItemsGroup,_)||(a.selectedItemsGroup=_),C(_)}),o(),g(85,Ke,2,0,"div",48),o(),i(86,"div",45)(87,"label",50),s(88,"Date"),i(89,"sup"),s(90,"*"),o()(),h(91,"input",51),g(92,Xe,2,1,"div",48),o(),i(93,"div",45)(94,"label",52),s(95,"Time"),i(96,"sup"),s(97,"*"),o()(),h(98,"input",53),g(99,Ze,2,1,"div",48),o(),i(100,"div",45)(101,"label",46),s(102,"Business Unit"),i(103,"sup"),s(104,"*"),o()(),i(105,"select",54)(106,"option",12),s(107,"Select Business Unit"),o(),g(108,et,2,2,"option",13),o()()(),i(109,"div",55)(110,"div",45)(111,"label",46),s(112,"Campaign Type"),i(113,"sup"),s(114,"*"),o()(),i(115,"ng-multiselect-dropdown",56),M("ngModelChange",function(_){return f(c),b(a.selectedItemsType,_)||(a.selectedItemsType=_),C(_)}),v("ngModelChange",function(){return f(c),C(a.updateValidation())}),o(),g(116,tt,2,0,"div",48),o(),g(117,rt,35,3,"div",57)(118,ut,24,5,"div",58)(119,yt,31,4,"div",59),o(),i(120,"div",44),g(121,It,2,0,"button",60)(122,Tt,2,0,"button",60),o()()()()()()()}if(r&2){let c=E(70);m(16),p("ngModel",-1),m(3),p("ngForOf",a.businessUnits),m(8),p("settings",a.dropdownSettings)("data",a.dropdownList),F("ngModel",a.selectedItems),m(6),F("ngModel",a.ipp),m(17),p("ngForOf",a.headers),m(5),p("ngForOf",a.headers),m(2),p("ngForOf",G(58,30,a.filteredCampaigns,L(33,he,a.ipp,a.p))),m(7),p("ngIf",a.message),m(5),p("formGroup",a.campaignForm),m(9),p("ngIf",(a.campaignForm.controls.name==null?null:a.campaignForm.controls.name.invalid)&&((a.campaignForm.controls.name==null?null:a.campaignForm.controls.name.dirty)||(a.campaignForm.controls.name==null?null:a.campaignForm.controls.name.touched))),m(6),p("settings",a.dropdownSettingsGroup)("data",a.dropdownListGroup),F("ngModel",a.selectedItemsGroup),p("ngModelOptions",V(36,ue)),m(),p("ngIf",c.submitted&&!a.selectedItemsGroup.length),m(7),p("ngIf",(a.campaignForm.controls.date==null?null:a.campaignForm.controls.date.invalid)&&((a.campaignForm.controls.date==null?null:a.campaignForm.controls.date.dirty)||(a.campaignForm.controls.date==null?null:a.campaignForm.controls.date.touched))),m(7),p("ngIf",(a.campaignForm.controls.time==null?null:a.campaignForm.controls.time.invalid)&&((a.campaignForm.controls.date==null?null:a.campaignForm.controls.date.dirty)||(a.campaignForm.controls.date==null?null:a.campaignForm.controls.date.touched))),m(9),p("ngForOf",a.businessUnits),m(7),p("settings",a.dropdownSettingsType)("data",a.dropdownListType),F("ngModel",a.selectedItemsType),p("ngModelOptions",V(37,ue)),m(),p("ngIf",c.submitted&&!a.selectedItemsType.length),m(),p("ngIf",a.dropdownListType[0].validation),m(),p("ngIf",a.dropdownListType[1].validation),m(),p("ngIf",a.dropdownListType[2].validation),m(2),p("ngIf",a.formType=="add"),m(),p("ngIf",a.formType=="edit")}},dependencies:[P,j,$,U,ie,Q,ee,te,z,Z,H,R,K,J,ae,X,Y,se,pe,me,re,le,ge,ce],styles:[".fs-20[_ngcontent-%COMP%]{font-size:20px;margin-right:5px}table[_ngcontent-%COMP%]{font-size:14px}th[_ngcontent-%COMP%]{vertical-align:top}.modal-dialog.group[_ngcontent-%COMP%]{max-width:75%}.template[_ngcontent-%COMP%]{max-height:75vh;overflow-y:auto;font-size:14px}.alert[_ngcontent-%COMP%]{padding:5px 10px}"]});let t=l;return t})();export{jt as ManageCampaignsComponent};
